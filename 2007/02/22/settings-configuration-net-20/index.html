
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Settings, Configuration, .NET 2.0 - Fail Better</title>
  <meta name="author" content="David aka t3rse">

  
  <meta name="description" content="{A while back I complained about configuration within Windows Forms applications, mostly because I lacked an understanding of the API. I hacked a &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.t3rse.com/2007/02/22/settings-configuration-net-20">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Fail Better" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-50368166-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Fail Better</a></h1>
  
    <h2>Ever tried. Ever failed. No matter. Try again. Fail again. Fail better.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.t3rse.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/articles">Articles</a></li>  
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Settings, Configuration, .NET 2.0</h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-02-22T23:21:00-06:00" pubdate data-updated="true">Feb 22<span>nd</span>, 2007</time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://blog.t3rse.com">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><div class='post'>
<span style="font-size:180%;color:#3333ff;">{<br /></span><br />A while back I complained about <a href="http://metadeveloper.blogspot.com/2006/11/configuration-api-convoluted.html">configuration</a> within Windows Forms applications, mostly because I lacked an understanding of the API. I hacked a simple xml file together wherein I could store simple name value pairs that we&#8217;d utilize for the application and surprisingly it&#8217;s been the approach for quite some time.<br /><br />I&#8217;ve been studying for the Microsoft 70-552 exam which would update my &#8220;MCAD&#8221; certification to &#8220;MCPD.&#8221; I know, I know, certification is frown upon by so many people who think I should really be reading <a href="http://www.ccs.neu.edu/home/matthias/BTLS/">The Little Schemer</a> to do <a href="http://dangermouse.brynmawr.edu/cs245/ycomb_jim.html">cool parlor tricks</a>. But this is a case where what I&#8217;d said earlier about certification rings true: it probes for weakness and exposes where you &#8220;fake it&#8221; with hacks without understanding the real structure and purpose of the technology. Case in point, configuration.<br /><br />In my earlier post, I&#8217;d used <span style="font-family:courier new;">Configuration.AppSettings</span> which I now know as deprecated. Instead there&#8217;s a nifty configuration/settings API one can leverage. What I&#8217;ve done here is based very heavily on Chris Sells&#8217;s Windows Forms 2.0 Programming although I took liberty to modify some of the code to make it more reusable and generic (his intent was to show basics).<br /><br />The first stop one needs to make is to add a Settings file to the project along with a reference to System.configuration (not sure why configuration is not Configuration).<br /><br /><img src="http://hobbitwerk.brinkster.net/metadeveloper/settingsSetup.jpg" /><br /><br />Underneath the properties node if you &#8220;edit&#8221; the settings file, it&#8217;s really a grid that allows you to enter settings with a key, datatype, scope, and value. The scope in here can be either as a user setting or an application setting - it&#8217;s also possible to write your own section handler and extend the model.<br /><br /><img src="http://hobbitwerk.brinkster.net/metadeveloper/settingsEntry.jpg" /><br /><br />After compiling this is converted into your app.exe.config file - the physical storage of your settings in the xml format well know to config files.<br /><br /><img src="http://hobbitwerk.brinkster.net/metadeveloper/settingsAppConfig.jpg" /><br /><br />The code for retrieval is still, in my own view, a little verbose but it&#8217;s easy to develop a simple accessor helper class. Even more slick in the design of the .NET Framework is that class library projects (DLLs) pull configuration settings from their hosted EXE so you the utility code here is from a DLL designed to be referenced and used from any application.<br /><br /><span style="font-family:courier new;font-size:78%;">using System;<br />using System.Collections.Generic;<br />using System.Text;<br />using System.Configuration;<br /><br />namespace SettingsGroperLib<br />{<br />public enum SettingType {<br />userSettings,<br />applicationSettings<br />}<br /><br />public class ConfHelp<br />{<br /><br />public static string GetConfSetting(SettingType settingType, string settingKey) {<br />// obtain current configuration<br />Configuration currentConfig =<br />ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);<br />// obtain section utilizing enumeration<br />ConfigurationSectionGroup group =<br />currentConfig.GetSectionGroup(settingType.ToString());<br />// get calling assembly settings class<br />string assemblyName = System.Reflection.Assembly.GetCallingAssembly().FullName;<br />// yah, it&#8217;s ugly, but it works<br />string friendlyName = assemblyName.Split(&#8216;,&#8217;)[0];<br />// obtain section by combining friendlyname to settings class<br />ClientSettingsSection section =<br />(ClientSettingsSection)group.Sections.Get(<br />String.Format(<br />&#8220;{0}.Properties.Settings&#8221;,<br />friendlyName<br />)<br />);<br />// get setting key<br />SettingElement element =<br />section.Settings.Get(settingKey);<br />// return settings value as<br />return element.Value.ValueXml.FirstChild.Value;<br />}<br /><br />}<br />}<br /></span><br />Sorry about the format; you can download a nice formated version <a href="http://hobbitwerk.brinkster.net/metadeveloper/ConfHelp.cs.txt">here</a>.<br /><br />It all seems so easy once you take the time. I think the unlearning was a big obstacle for me since working with config files was something I did all the time in .NET 1.x and old habits die hard. Oh yeah, the retrieval:<br /><br /><span style="font-family:courier new;font-size:78%;">string test = ConfHelp.GetConfSetting(SettingType.applicationSettings, &#8220;DBUrl&#8221;);</span><br /><br /><span style="font-size:180%;color:#3333ff;">}</span></div>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">David aka t3rse</span></span>

      








  


<time datetime="2007-02-22T23:21:00-06:00" pubdate data-updated="true">Feb 22<span>nd</span>, 2007</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://blog.t3rse.com/2007/02/22/settings-configuration-net-20/" data-via="t3rse" data-counturl="http://blog.t3rse.com/2007/02/22/settings-configuration-net-20/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2007/02/20/language-of-gods/" title="Previous Post: Language of the Gods">&laquo; Language of the Gods</a>
      
      
        <a class="basic-alignment right" href="/2007/02/23/configuration-ammendment/" title="Next Post: Configuration Ammendment">Configuration Ammendment &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2014/06/04/trend-talk/">Trend Talk</a>
      </li>
    
      <li class="post">
        <a href="/2014/05/07/going-mac/">Going Mac: A Developer Encountering Operating Systems as Place</a>
      </li>
    
      <li class="post">
        <a href="/2014/05/06/moving-from-blogengine-dot-net-to-octopress/">Moving From BlogEngine.net to Octopress</a>
      </li>
    
      <li class="post">
        <a href="/2014/04/21/hello-from-octopress/">Hallo Welt: Octopress Edition</a>
      </li>
    
      <li class="post">
        <a href="/2014/02/23/The-Day-Barry-Ritholtz-Replied/">The Day Barry Ritholtz Replied</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/t3rse">@t3rse</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 't3rse',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - David aka t3rse -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 't3rse';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
