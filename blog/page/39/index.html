
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Fail Better</title>
  <meta name="author" content="David aka t3rse">

  
  <meta name="description" content="{Here are the examples from the last piece of the course when we explored the .NET Framework&#8217;s implementation of XML related parsers and &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.t3rse.com/blog/page/39">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Fail Better" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-50368166-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Fail Better</a></h1>
  
    <h2>Ever tried. Ever failed. No matter. Try again. Fail again. Fail better.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.t3rse.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/articles">Articles</a></li>  
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2005/06/16/xml-net-custom-samples/">XML .NET (the Custom Samples)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2005-06-16T08:34:00-05:00" pubdate data-updated="true">Jun 16<span>th</span>, 2005</time>
        
           | <a href="/2005/06/16/xml-net-custom-samples/#disqus_thread"
             data-disqus-identifier="http://blog.t3rse.com/2005/06/16/xml-net-custom-samples/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<span style="color: rgb(0, 0, 153);font-size:180%;" >{</span><br /><span style="font-size:85%;"><br />Here are the examples from the last piece of the course when we explored the .NET Framework&#8217;s implementation of XML related parsers and techniques.<br /><br />You can download the sample in this zip file which you can extract to its project form to look at the code. Most examples are &#8220;methods&#8221; implemented off of Module1.vb1.<br /><br /><span style="font-weight: bold;font-size:100%;" >Read and Write</span><br /><br />The <span style="font-weight: bold; color: rgb(255, 102, 0);">BasicReader()</span> method shows an example of parsing an XML document with a XmlReader. Pay attention to the Select… Case expression to see how to filter nodes based on their types.<br /><br />The <span style="font-weight: bold; color: rgb(255, 102, 0);">ValidReader()</span> method shows an example of a validating parser (XmlValidatingReader). Although this method does the legwork, our ValidationEventHandler, the method <span style="color: rgb(255, 102, 0); font-weight: bold;">ValidError()</span> is responsible for responding to any &#8220;events&#8221; related to the validation. I stressed the importance of understanding Delegates here, and did a quick example of what I meant which you can download in a different project, <a href="http://hobbitwerk.brinkster.net/metadeveloper/vbDel.zip">vbDel</a>. If you don&#8217;t mind looking at C#, you can look at some earlier entries I made about how delegates work. One of the best uses of delegates is to make an asynchronous call to any method you&#8217;ve written. Asynchronous delegates are how asynchronous web service calls are implemented.<br /><br />The fake SAX Parser we wrote is also in the project, in its own file called<span style="color: rgb(255, 102, 0);"> SAXP.vb</span>. It is not very complete but should give you an idea of how to get the SAX functionality out of the .NET Framework. If you&#8217;d ever want to – that&#8217;s probably a remote possibility.<br /><br />The <span style="font-weight: bold; color: rgb(255, 102, 0);">WriteXML()</span> method is a very basic example of how you can use the XmlTextWriter to create XML documents. This isn&#8217;t too interesting, but if you start to combine the XmlTextReader and the XmlTextWriter, you can start to see the power and ease of the .NET APIs. In the second group, we wrote some code that would convert an attribute based document into an element based one. You will find this in a method called <span style="font-weight: bold; color: rgb(255, 102, 0);">AttToElement()</span>.<br /><br /><span style="font-weight: bold;font-size:100%;" >Transforming</span><br /><br />The <span style="font-weight: bold; color: rgb(255, 102, 0);">SimpleTransform()</span> method is an example of the simplest form of XSLT Transformations that can be done with the .NET Framework. Another method, called <span style="color: rgb(255, 102, 0); font-weight: bold;">MemoryTransform()</span>, is an example of how transformation can be done and processed in memory to return results in a string format. You will notice the use of the MemoryStream class in this example.<br /><br /><span style="font-weight: bold;font-size:100%;" >Serialization</span><br /><br />We took two different looks at serialization. In the first we looked at how a built in class, the DataSet, has the ability to persist itself in XML format. Our method <span style="color: rgb(255, 102, 0); font-weight: bold;">PersistDataSet()</span> shows an example of this.  In order to demonstrate the retrieval of a persisted DataSet, we wrote another method called <span style="color: rgb(255, 102, 0); font-weight: bold;">ReadPersistedDataSet()</span>. Along the way we talked about the Schema options of the WriteXml method of the DataSet. Although it was a barely noticeable blurb, make sure you investigate the XmlDataDocument class. It&#8217;s a quick way to go from a DataSet to an XML Dom-like object and back again.<br /><br />Once we&#8217;d seen that type of persistence, we looked at conventional serialization, or being able to take any old class and serialize it into some output stream. We wrote the <span style="font-weight: bold; color: rgb(255, 102, 0);">PersistConventional()</span> method to display this functionality with a class called Person, and then we depersisted in a method called <span style="color: rgb(255, 102, 0); font-weight: bold;">DepersistConventional()</span>.<br /><br />This was a good way to start working at understanding web services. I&#8217;ll make another entry with the web services demos, but really quickly, the last few examples related to XML and .NET:<br /><br /><span style="font-weight: bold;font-size:100%;" >XML and SQL Server 2000</span><br /><br />We looked at ways to retrieve XML data from the database, and I demonstrated the FOR XML clause of an sql statement. After we looked at a few examples, we wrote the <span style="color: rgb(255, 102, 0); font-weight: bold;">GetXMLFromDB()</span> method that would issue a FOR XML query and return results using the XmlReader. Which left us with one other thing on our &#8220;to do&#8221; list: inserting XML data into SQL Server directly.<br /><br />In the project you will find a file called OPENXML.sql. This file contains a series of scripts to work through to understand how one can use the OPENXML function in SQL Server 2000 to build a &#8220;rowset&#8221; view on an XML document. Once this rowset functionality is understood, it&#8217;s easy to see how it can be combined with Insert/Select statements to insert data. This is demonstrated in the <span style="color: rgb(255, 102, 0); font-weight: bold;">InsertXMLContent()</span> method.<br /><br />So that was the <span style="font-style: italic;">tour de force</span>.  You can download it all in <a href="http://hobbitwerk.brinkster.net/metadeveloper/nsBasic.zip">this zipped project</a>.  If you have questions, don&#8217;t hesitate to email me.  </span><br /><br /><span style="font-size:180%;"><span style="color: rgb(0, 0, 153);">}</span></span></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>kevinflynn9768</div>
<div class='content'>
<B>St0ck For Your Review - FCPG</B><BR/><BR/>Current Profile<BR/>Faceprint Global Solutions <B>(FCPG)</B> <BR/>Current Price $0.15<BR/><BR/>A U.S. based-company dedicated to the goal of <BR/>bringing effective security solutions to the marketplace.<BR/><BR/><B>With violent and white-collar terrorism on the rise, <BR/>companies are starving for innovative security solutions.</B> <BR/><BR/>FCPG is set to bring hot new security solutions to <BR/>the industry, <B>with currently over 40 governmental and <BR/>non-governmental contracts, being negotiated.</B><BR/><BR/>Please Review Exactly What this Company Does.<BR/><BR/><B>Why consider Faceprint Global Solutions (FCPG)?</B> <BR/><BR/>Faceprint Global Solutions (FCPG) holds the exclusive <BR/>marketing rights from Keyvelop, to sell the world�s <BR/>leading encryption technology to be distributed directly <BR/>to the Healthcare industry in North America.<BR/><BR/>Faceprint Global Solutions has completed its biometric <BR/>software that recognizes facial features of individuals <BR/>entering and leaving through airports, ship yards, banks, <BR/>large buildings, etc. <BR/><BR/>FCPG acquired Montreal-based Apometrix Technologies, <BR/>which enhances the companies mission of being a <BR/>full-service provider to the multi-application smart <BR/>card industry. The North American market appears ready <BR/>for significant expansion of price-competitive, proven, <BR/>multi-application solutions on smart cards. <B>Apometrix&#8217;s <BR/>forecast of over 300 customers and sales of more than $50 <BR/>million in North America over the next five years, appears <BR/>very realistic, according to company management.</B> <BR/><BR/>Faceprint Global Solutions is currently in contract negotiations <BR/>with over 40 governmental agencies and businesses seeking to use <BR/>their encryption, biometric, and smart-card technologies.<BR/><BR/><B>Breaking News for Faceprint Global Solutions (FCPG)</B><BR/><BR/>Faceprint Global Solutions (FCPG) <B><I>is pleased to announce that <BR/><B>IBM</B> will now offer the world�s leading encryption software to <BR/>its major Healthcare clients in North America.</B></I><BR/><BR/>With FCPG owning the exclusive North American rights to distribute <BR/>the worlds leading encryption and transmission software developed by <BR/>Keyvelop, <B><I>FCPG is poised to capture large volumes of sales generated <BR/>by customers currently using IBM�s software in the healthcare and other <BR/>industries.</B></I><BR/><BR/>�This is a very positive move for FCPG and for Keyvelop,� said FCPG <BR/>CEO Pierre Cote. �We are very happy about the decision to go with IBM. <BR/>This is a continuation of the progress made by everyone associated <BR/>with FCPG and its partners.�<BR/><BR/>Buell Duncan, IBM&#8217;s general manager of ISV & Developer Relations commented, <BR/>�Collaborating with Keyvelop will ensure that we develop open solutions that <BR/>are easy to maintain and cost effective for our customers in the healthcare <BR/>and life sciences industry.�<BR/><BR/>Among other things, this new software technology which is currently <BR/>being used by a number of European healthcare companies, is used to <BR/>send any file, regardless of format or size. Encryption keys, evidence <BR/>of transmission integrity with fingerprint calculation, time-stamping <BR/>of all actions and status record updating, pre-checking sender and <BR/>receiver identities, validating file opening dates are part of Keyvelop features.<BR/><BR/><B>About FacePrint Global Solutions, Inc.</B><BR/><BR/>FCPG operates a business, which develops and delivers a variety of <BR/>technology solutions, including biometric software applications on <BR/>smart cards and other support mediums (apometric solutions). FCPG�s <BR/>products provide biometric solutions for identity authentication and a <BR/>host of smart card- and biometrics-related hardware peripherals and <BR/>software applications. Apometrix, FCPG�s wholly-owned subsidiary, <BR/>combines on-card or in-chip multi-application management solutions <BR/>with best-of-breed �in-card matching� biometrics. Keyvelop�s secure <BR/>digital envelope solution and Apometrix�s on-card biometrics work <BR/>together to produce the winning combination in the fields of security, <BR/>traceability and identity management. <BR/><BR/><B>Conclusion:</B><BR/><BR/>The examples above show the Awesome, Earning Potential of little known <BR/>Companies That Explode onto Investor�s Radar Screens. This sto,ck will <BR/>not be a Secret for long. Then You May Feel the Desire to Act Right Now! <BR/>And Please Watch This One Trade! <BR/><BR/><B>GO FCPG!</B><BR/><BR/>Disclaimer:<BR/>Information within this email contains &#8220;forward |ooking statements&#8221; within <BR/>the meaning of Section 27Aof the Securities Act of 1933 and Section 21B of <BR/>the Securities Exchange Act of 1934. Any statements that express or involve <BR/>discussions with respect to predictions, expectations, beliefs, plans, <BR/>projections, objectives, goals, assumptions or future events or performance <BR/>are not statements of historical fact and may be &#8220;forward |ooking statements&#8221;. <BR/>&#8220;Forward |ooking statements&#8221; are based on expectations, estimates and projections <BR/>at the time the statements are made that involve a number of risks and uncertainties <BR/>which could cause actual results or events to differ materially from those presently <BR/>anticipated. We were paid a sum of three thousand USD to disseminate this information <BR/>from ir marketing. Forward loking statements in this action may be identified through <BR/>the use of words such as &#8220;projects&#8221;, &#8220;foresee&#8221;, &#8220;expects&#8221;, &#8220;will&#8221;, &#8220;anticipates&#8221;,<BR/>&#8220;estimates&#8221;, &#8220;believes&#8221;, &#8220;understands&#8221; or that by statements indicating<BR/>certain actions &#8220;may&#8221;, &#8220;could&#8221;, or &#8220;might&#8221; occur. Risk factors include<BR/>general economic and business conditions, the ability to acquire and develop <BR/>specific projects, the ability to fund operations and changes in consumer and <BR/>business consumption habits and other factors over which the company has little <BR/>or no control. The publisher of this newsletter does not represent that the <BR/>information contained herein are true and correct.</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2005/06/15/java-samples/">Java Samples</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2005-06-15T05:50:00-05:00" pubdate data-updated="true">Jun 15<span>th</span>, 2005</time>
        
           | <a href="/2005/06/15/java-samples/#disqus_thread"
             data-disqus-identifier="http://blog.t3rse.com/2005/06/15/java-samples/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<span style="color: rgb(0, 0, 153);font-size:180%;" >{</span><br /><br /><span style="font-size:85%;">Generated during class with South Dakota State employees but hopefully useful to anyone who wanders this way.<br /><br />[<span style="color: rgb(255, 0, 0); font-weight: bold;">NOTE: My web host doesn&#8217;t serve the *.java files, so download the zipfile at the end of this post instead. I&#8217;ll rename with *.txt later.</span>]<br /><br />We began things with a Hello World program in <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/Hello.java">Hello.java</a>. Soon after we talked about defining classes, the basic building block of any java program. <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/Clerk.java">Clerk.java</a> shows an example of a class with fields, methods, getters and setters (accessor methods), and a constructor. Along the way we also learned about overloading, as seen in <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/Calculator.java">Calculator.java</a>.<br /><br />We learned more details about class definitions: <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/Clock.java">Clock.java</a> (check with <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/TestClock.java">TestClock.java</a>) and <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/Employee.java">Employee.java</a> are examples of how you can chain constructors. <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/BankAccount.java">BankAccount.java</a> was used to show the difference between static and instance methods and fields.  You can see the BankAccount class tested in <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/Thursday.java">Thursday.java</a>.  Once we were comfortable with the static keyword, we talked about defining constants, using <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/Constants.java">Constants.java</a> as our example.<br /><br />We had a chapter that covered arrays, in which we looked at <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/UsingArrays.java">UsingArrays.java</a>. I added an aside about Collection classes in java, which are a more robust alternative to arrays in most cases, and we looked at <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/Swapmeet.java">Swapmeet.java</a>. Even though I got the bubble sort wrong in class, it&#8217;s fixed in this example with some helper methods, sortMyArray and printArray. We looked at working with Calendars and dates in <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/TestBed.java">TestBed.java</a>.  I also included a <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/DateDiff.java">DateDiff.java</a> that shows how to get the functionality of a basic DateDiff command.  Like other things, it&#8217;s ugly in java.<br /><br />You saw one class from the swing library, the JOptionPane, which was used to talk about getting user input. I also showed you the BufferedReader along with it in <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/Dialoging.java">Dialoging.java</a>. I would recommend the BufferedReader approach if your application runs from the command line, personally. For most other examples in class, we used <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/EasyConsole.java">EasyConsole.java</a>, which abstracted reading and writing from the console with a few simple methods.<br /><br />At this point we began to cover inheritance.  We looked at a basic inheritance heirarchy in <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/Person.java">Person.java</a>, <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/InhEmployee.java">InhEmployee.java</a>, and <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/Executive.java">Executive.java</a>.  We looked at abstract classes in <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/Shape.java">Shape.java </a>and we briefly looked at interfaces in <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/IPrintable.java">IPrintable.java</a>.<br /><br />We closed out with the basics of exception handlers and subclassing exception. The try{..}catch{&#8230;}finally{&#8230;} is probably best introduced by your material.<br /><br />Our final two topics were File I/O and parsing XML documents.  On the File I/O side, I had two classes: <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/DavidFileReader.java">DavidFileReader.java</a> to demonstrate methods of reading from a file stream, and <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/DavidFileWriter.java">DavidFileWriter.java</a>, to demonstrate writing to a file stream.  In terms of XML, I have a class called <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/Xreader.java">Xreader.java</a> which should help you get started parsing XML files.<br /><br />Wow, that was a lot for three days. Even typing it out makes me tired. In regards to the samples, you can download them individually, or you can <a href="http://hobbitwerk.brinkster.net/metadeveloper/PierreJava/Classfiles.zip">download a zip archive</a> of the entire set.  If you have questions or comments, don&#8217;t hesitate to email me.</span><br /><br /><span style="color: rgb(0, 0, 153);font-size:180%;" >}</span></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2005/05/13/itunes-hacking/">iTunes Hacking</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2005-05-13T15:26:00-05:00" pubdate data-updated="true">May 13<span>th</span>, 2005</time>
        
           | <a href="/2005/05/13/itunes-hacking/#disqus_thread"
             data-disqus-identifier="http://blog.t3rse.com/2005/05/13/itunes-hacking/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<span style="color: rgb(0, 0, 153);font-size:180%;" >{</span><br /><br />So I am still coming to terms with how <a href="http://www.apple.com/itunes/">iTunes</a> works, and trying to get the &#8220;philosophy&#8221; behind its organization system. My understanding is this: iTunes can scour the hard drive, if you allow it, and maintain a nice library of tracks, no matter where on your physical disk they are located. You can then sift through by artist, etc&#8230;<br /><br />In my case I have ~30 GB of music and much of it isn&#8217;t in mp3 files with ID3 tags - I&#8217;ve got a pot pourri of mixes and a ton of podcasts I&#8217;ve been listening to while I work. It&#8217;s too much of a pain to manually create a playlist for all the folders or try to find unlabeled music in the library. Maybe it&#8217;s because of winamp but I&#8217;m used to organizing my music physically, and then grabbing tracks out of a directory that I want to play, rather than by &#8220;artist&#8221; or &#8220;genre.&#8221; For example, I&#8217;ve got the following:<br /><br />-/Mp3<br />&#8212;-/PodCast<br />  &#8212;&#8212;&#8211;/ITConversations<br />&#8212;&#8212;&#8211;/KCRW<br />  &#8212;&#8212;&#8211;&#8230; and so on<br /> &#8212;-/Albums<br />  &#8212;&#8212;&#8211;/Interpol<br />&#8212;&#8212;&#8211;    /Massive Attack<br />&#8212;&#8212;&#8211;    &#8230; and so on<br />&#8212;-/Mixes<br />&#8212;&#8212;&#8211;    /Jan2005<br />  &#8212;&#8212;&#8211;/Feb2005<br />&#8212;&#8212;&#8211;    /Mar2005<br />  &#8212;&#8212;&#8211;&#8230; and so on<br /><br />This scheme works well, but it doesn&#8217;t seem to mesh with iTunes. So I wrote a little program using the <a href="http://developer.apple.com/sdk/itunescomsdk.html">iTunes COM SDK</a> that takes a directory as a parameter and automatically creates a playlist for each folder that contains mp3 or other music files. In my case it worked perfectly (took seconds!) in creating playlists for all my folders and the files they contained. I put in a &#8220;Sync&#8221; button too, so it can synchronize with changes you make to file structure.<br /><br /><br /><img src="http://hobbitwerk.brinkster.net/metadeveloper/iTunesBuilder.gif" /><br /><br />I&#8217;ve uploaded a <a href="http://hobbitwerk.brinkster.net/metadeveloper/iTunesBuilder.zip">*.zip</a> along with source (it&#8217;s written in VB6). I tested it with iTunes 4.7 and it works fine. I&#8217;m not sure whether this was unnecessary; perhaps iTunes has an option for doing just this, I don&#8217;t know. But more deeply, I think, is an attitude, an approach of giving the user an interaction with a piece of software.  In the PC world, one spends a lot more time &#8220;organizing&#8221; things than does on one on a Mac.  I&#8217;ve heard and read often that systems should be able to manage themselves but find myself balking at the notion that the system can do as good of a job as I can.  I download faster than I listen, so things must be organized, but the content of the audio is the archival attribute, not the date, artist, or genre.  How this can be known outside of the user, I&#8217;m not sure.<br /><br />If you do make a modification, or an improvement (many probably could be made), let me know. I&#8217;m also unaware of any <span style="font-style: italic;">plug-in</span> architecture for iTunes, otherwise I&#8217;d try to just make it a couple of buttons or menu items in the program itself.<br /><br /><span style="color: rgb(0, 0, 153);font-size:180%;" >}</span></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Phil</div>
<div class='content'>
I have the exact same problem. I always order my music by directories and such instead of proprietary metadata. Instead of creating playlists (which will limit the solution to iTunes) my idea is to fix the id3 tags so that they include track-numbering. (That way it will work with Muine, Rhythmbox, etc.) Unfortunately WinAmp and XMMS are the only players I know that can sort by filename.<BR/><BR/>I&#8217;m working on a Ruby solution. Check http://philisha.net in a few weeks.<BR/><BR/>As for which way of organization is superior, I think there is something to be said for the iTunes way. Organizing a 30GB collection of music is a rather mundane task; you shouldn&#8217;t HAVE to do it manually.<BR/><BR/>Unfortunately, the iTunes way really only works if you&#8217;ve been using iTunes from the start and if you don&#8217;t use your music library on other players. So it&#8217;s nice in theory, but I think I&#8217;ll still spend an unfortunate amount of time managing stuff myself.</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2005/05/12/supporting-each-other-vb6-in-longhorn/">Supporting Each Other, VB6 in Longhorn</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2005-05-12T00:09:00-05:00" pubdate data-updated="true">May 12<span>th</span>, 2005</time>
        
           | <a href="/2005/05/12/supporting-each-other-vb6-in-longhorn/#disqus_thread"
             data-disqus-identifier="http://blog.t3rse.com/2005/05/12/supporting-each-other-vb6-in-longhorn/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<span style="color: rgb(0, 0, 153);font-size:180%;" >{</span><br /><br />I <a href="http://metadeveloper.blogspot.com/2005/03/done-not-dead.html">posted</a> a bit ago about Microsoft&#8217;s MVP revolt with regards to supporting VB6.  They&#8217;ve responded in kind with <a href="http://msdn.microsoft.com/vbrun/">VBrun</a>, &#8220;Visual Basic 6.0 Resource Center.&#8221;<br /><br />The product manager for Visual Basic, Jay Roxe, responded to the petition <a href="http://blogs.msdn.com/JRoxe/">on his blog</a> and, most importantly, has acknowledged support for VB6 in Longhorn:<br /><blockquote></blockquote>&#8220;However, I want to highlight to you that Microsoft is still supporting Visual Basic 6 and will continue to for quite some time.  In fact, the Visual Basic 6 runtime is slated to ship as a part of Windows Longhorn, which means that it will be covered under Longhorn’s support lifecycle.&#8221;<blockquote></blockquote>I&#8217;m an<span style="font-weight: bold;"> unapologetic lover of VB6</span>, and find myself still using it all the time for helpful utilities.  Most recently I wrote a tool using the <a href="http://developer.apple.com/sdk/itunescomsdk.html">Apple iTunes COM SDK</a> to sync my physical arrangements of mp3s and folders with the playlists that it created. It&#8217;s a nifty tool, and I&#8217;ll post about it soon along with source code.<br /><br /><span style="color: rgb(0, 0, 153);font-size:180%;" >}</span></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2005/05/11/vasters-on-soa/">Vasters on SOA</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2005-05-11T23:28:00-05:00" pubdate data-updated="true">May 11<span>th</span>, 2005</time>
        
           | <a href="/2005/05/11/vasters-on-soa/#disqus_thread"
             data-disqus-identifier="http://blog.t3rse.com/2005/05/11/vasters-on-soa/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<span style="font-size:180%;">{</span><br /><br />A small time ago I <a href="http://metadeveloper.blogspot.com/2005/02/more-soa.html">admitted </a>that SOA is still a bit elusive to me as this ubiquitous need we were all unaware of having.  Multiple marketing machines are in full swing with it, however, and it&#8217;s hard to separate useful and useless facts, much less fact and fiction.<br /><br />I found a lengthy <a href="http://java.sun.com/developer/technicalArticles/WebServices/soa/">article </a>on java.sun.com which should prove to be more technical (and therefore more useful) but meanwhile I&#8217;m also beginning to find some other questions similar to my own. <br /><br />Clemens Vasters writes in his <a href="http://staff.newtelligence.net/clemensv/PermaLink,guid,535d4a96-2cc3-4306-8b56-9a96c7c6fa39.aspx">blog</a>:<br /><br /><blockquote>&#8221; When you look at what’s being advertised as “serviced oriented architecture”, you see either the marketing-glorified repackaging of Ethernet, TCP/IP, and LDAP (“Enterprise Service Bus”), or architectural blueprints that looks strikingly similar to things that people have been doing for a long time with DCE, CORBA, J2EE, COM, or mainframe technologies. What’s different now is that it is easier, cheaper and likely more productive to create bridges between systems. &#8221;</blockquote><br /><br />A Bill Simser <a href="http://weblogs.asp.net/bsimser/archive/2005/05/04/405642.aspx">responds</a>:<br /><br /><blockquote>&#8220;Indeed at the lower levels of the architecture stack the base concepts of SO have been around as good practices for years. However, we as an industry haven&#8217;t been applying these base concepts consistently or properly across solutions so it&#8217;s somewhat academic. If calling them SOA means that people now pay attention to them and somehow feel better about using them, then that&#8217;s reason enough for me to accept that SOA exists. &#8221;</blockquote><br /><br />And finally, visiting his blog, I read something that gels the concept a bit more clearly as he speculates on how SAP might have been implemented in a SOA world:<br /><br /><blockquote>&#8220;But what if the architects for SAP had applied SOA from the get-go? The actual architecture would have been defined as several aggregations of financial capabilities (like accounts, money movements, and so on) with appropriate service contracts. It would have also included a collection of capability that would be needed by the finance functions of a typical organization, again with appropriate service contracts. It would have have included some UI capabilities (Web Parts if they were really on the ball) that could consume these services (and indeed other services from different providers) and have the &#8220;appearance&#8221; of a traditional &#8220;application&#8221;. However, as architects we would recognize that what the user thinks is the &#8220;application&#8221; is really just a thin facade to the orchestrations of functions they need. An important additional capability is to easily orchestrate other services that are not part of SAP (for example, a service with AMEX to get your credit card statements that can augment expense reports).&#8221;</blockquote><br /><br />Definitely food for thought, with my own response as follows:<br /><br /><blockquote>Relating to your speculating about SAP, however, a few things come to mind. First, a different way of thinking when it comes to enterprise applications. You are right when you say that &#8220;traditional&#8221; thinking lies around task automation rather than loosely coupled &#8220;services&#8221; that are stitched together by consuming applications (or environments).  <br />  <br />But how much of development revolves around loosely coupled services versus automation? Has the nature of the application changed to justify all the force behind service orientation? In one sense I can see it: the elegance of separate, contractual, modular partners, on the other I see architecture astronauts [<a target="_new" href="http://www.joelonsoftware.com/articles/fog0000000018.html">http://www.joelonsoftware.com/articles/fog0000000018.html</a>] building a massive framework that ultimately doesn&#8217;t propel us.    <br />  <br />All this talk of &#8220;contracts&#8221; and &#8220;services&#8221; and so on, and I contrast this with Amazon ECS - making requests for XML formatted data over HTTP: simple, elegant, and effecient. </blockquote>The journey continues, but it&#8217;s midnight and tomorrow&#8217;s coming fast.<br /><br /><span style="color: rgb(0, 0, 153);font-size:180%;" >}</span></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Bil Simser</div>
<div class='content'>
But Amazon ECS is exactly the point. Their &#8220;architecture astronauts&#8221; did a lot of heavy lifting so their Web Services would indeed be &#8220;simple, elegant, and efficient&#8221; for the users of these services. Behind these contracts are significant systems (it&#8217;s not just XML data), and many other services that they orchestrate for you. It just appears simple from the outside looking in (which is a good end result).<BR/> <BR/>When we can publish Web Services that are as easy for our customers to use as theirs are for their customers, we&#8217;ll be somewhere too. I don&#8217;t imagine it will be simple behind the contract, at least initially.</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2005/04/26/asynchronous-delegates-with-c/">Asynchronous Delegates With C#</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2005-04-26T23:38:00-05:00" pubdate data-updated="true">Apr 26<span>th</span>, 2005</time>
        
           | <a href="/2005/04/26/asynchronous-delegates-with-c/#disqus_thread"
             data-disqus-identifier="http://blog.t3rse.com/2005/04/26/asynchronous-delegates-with-c/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<span style="color: rgb(0, 0, 153);font-size:180%;" >{</span><br /><br />In <a href="http://metadeveloper.blogspot.com/2005/04/beginning-with-delegates-in-c.html">my previous article</a> on delegates in C#, I gave the syntactical basics of delegates as well as a very rough idea of how they could be used in a callback scenario. This time I&#8217;d like to revisit the concept of delegates but take it a step further and show you how the .NET Framework wraps the ability to make asynchronous calls right into the capabilities of delegates. In short, once an instance of a delegate is obtained, it comes with <span style="color: rgb(255, 0, 0);">BeginInvoke(&#8230;)</span> and <span style="color: rgb(255, 0, 0);">EndInvoke(IAsyncResult)</span> methods that can be used to piece together an asynchronous call.<br /><br />In my previous example, we used a class called DB that had a method called RunLongQuery to fake the notion of something that takes a long time. However, it&#8217;s not difficult to write code that chews away CPU and I/O cycles so this time around we&#8217;ll use a class that really does take some time to do its work:<br /><br /><span style="font-size:85%;"><span style="color: rgb(51, 51, 255);">public class</span> FileMapper{<br />         <span style="color: rgb(51, 51, 255);">public string</span> MapHeirarchy(<span style="color: rgb(51, 51, 255);">string </span>startPoint, <span style="color: rgb(51, 51, 255);">int </span>thresh, <span style="color: rgb(51, 51, 255);">bool </span>top){&#8230;}<br />}</span><br /><br />Our class, FileMapper, has a method called MapHeirarchy which takes a directory path, a threshold, and a boolean flag as its respective arguments. The overall goal of this method is simple: you pass it a path and it will graphically map out the directory structure. The integer and boolean arguments are there because the method is called recursively. So if I wrote the following code:<br /><br /><span style="font-size:85%;">FileMapper map = <span style="color: rgb(51, 51, 255);">new </span>FileMapper();<br />map.MapHeirarchy(&#8220;C:&#92;CODE&#8221;, 0, <span style="color: rgb(51, 51, 255);">true</span>);</span><br /><br />I&#8217;d get a list of the folders underneath the code directory returned as a string. It would look like:<br /><br /><span style="font-size:85%;">Mapping C:\CODE<br />-PROJA<br />&#8211;PROJASUB<br />&#8211;PROJASUB2<br />-PROJB<br />&#8211;PROJBSUB<br />&#8211;PROJBSUB2</span><br /><br />Not the most exciting thing in the world, but it can take a long time. For example, to map my C:\Program Files directory took 1 minute and 58 seconds on my Thinkpad. If we have methods such as this, which will take some time to run their course, they are good candidates for an asynchronous call. Asynchronous, in this case, means that once the method call is made, our code will continue executing until <span style="font-style: italic;">we check to see</span> that the method has completed. We don&#8217;t have to write a lick of thread management code in order to get this behavior; it&#8217;s all built in for us as long as we know how to define a delegate.<br /><br />The syntactical basics of delegates should be straightforward if you saw the earlier article. We&#8217;ll add a delegate to the FileMapper class so that we can call the MapHeirarchy method asynchronously:<br /><br /><span style="font-size:85%;"><span style="color: rgb(51, 51, 255);">public class </span>FileMapper{<br />         <span style="color: rgb(51, 51, 255);">public delegate string</span> MapAsync(<span style="color: rgb(51, 51, 255);">string </span>startPoint, <span style="color: rgb(51, 51, 255);">int </span>thresh, <span style="color: rgb(51, 51, 255);">bool </span>top);<br /><br />          <span style="color: rgb(51, 51, 255);">public string</span> MapHeirarchy(<span style="color: rgb(51, 51, 255);">string </span>startPoint, <span style="color: rgb(51, 51, 255);">int </span>thresh<span style="color: rgb(51, 51, 255);"><span style="color: rgb(0, 0, 0);">,</span> bool </span>top){&#8230;}<br />}</span><br /><br />The MapAsync delegate matches the return value and arguments of the method we intend to use it for, MapHeirarchy. I like to call delegates &#8221;<span style="font-style: italic;">typesafe </span>method pointers&#8221; and point out that they are &#8220;typesafe&#8221; because you can only point to a method that has the same return type and arguments.<br /><br />In the class where we are leveraging the FileMapper class, we create an anonymous instance of the class to map the MapHeirarchy method of the instance to an instance of the MapAsync delegate. Sounds like a lot, but it&#8217;s really just a single line of code:<br /><br /><span style="font-size:85%;">FileMapper.MapAsync mp = </span><span style="color: rgb(51, 51, 255);font-size:85%;" >new </span><span style="font-size:85%;">FileMapper.MapAsync(new FileMapper().MapHeirarchy);</span><br /><br />In order to make the asynchronous call, <span style="font-style: italic;">rather </span>than invoking the delegate outright like this:<br /><br /><span style="font-size:85%;">mp(&#8220;C:&#92;DIR&#8221;, 0, true);</span><br /><br />we will use the BeginInvoke method of the delegate like this:<br /><br /><span style="font-size:85%;">IAsyncResult v = mp.<span style="color: rgb(255, 0, 0);">BeginInvoke</span>(&#8220;C:&#92;Code05&#8221;, 0, <span style="color: rgb(51, 51, 255);">true</span>, <span style="color: rgb(51, 51, 255);">null</span>, <span style="color: rgb(51, 51, 255);">null</span>);</span><br /><br />From left to right, an object which implements the IAsyncResult interface is returned from an asynchronous call. This is, quite simply, the object which we can &#8220;ask&#8221; about when the method has finished executing and which will allow us to retrieve the results of the method&#8217;s execution. The mp.BeginInvoke is the call to our delegated method along with the first three arguments which we&#8217;ve seen defined above. The last two arguments, passed as nulls in this instance can be ignored; they must be a part of the call, but we don&#8217;t have to know what they are just yet.<br /><br />The IAsyncResult object has an IsCompleted property which holds a boolean flag indicating whether the method has completed. We can write simple code to poll this property until the method has finished its execution:<br /><br /><span style="font-size:85%;"><span style="color: rgb(51, 51, 255);">while</span>(!v.<span style="color: rgb(255, 0, 0);">IsCompleted</span>){<br /> Console.WriteLine(&#8220;Method still executing&#8230; &#8220;);<br />}</span><br /><br />Under normal circumstances you may take advantage of a loop like this to display or draw an animation that allowed a user to know that processing was taking place. There are many different directions that this could be taken but it suffices to say that at this point the method you&#8217;ve invoked is executing asynchronously and you&#8217;re free to carry on with whatever code follows it.<br /><br />To retrieve the result from the method, we must again ask the IAsyncResult object.  Our code may look as follows:<br /><br /><span style="font-size:85%;"><span style="color: rgb(51, 51, 255);">if</span>(v.IsCompleted){<br /> <span style="color: rgb(51, 51, 255);">string </span>tmp = mp.<span style="color: rgb(255, 0, 0);">EndInvoke</span>(v);<br /> Console.Write(tmp);<br />}</span><br /><br />Notice that after the IsCompleted method returns a true value we have the ability to use our delegate and call the EndInvoke method, passing it the IAsyncResult object to get our return value. The implementation is super slick here because the return type of the EndInvoke method is the return type of the original method!<br /><br />So here we see delegates one step further: the ability to make an asynchronous call with a delegate without having to worry about Threads, Synchs, Timers, or Locks. We also can see a way in which any method has the potential to be made asynchronous, as long as it has an associated delegate to go along with it. Finally, remember that you can define your own delegates for any method. The delegate that allows you to make an asynchronous call does not have to be defined in the same class whose methods you want to call asynchronously.<br /><br />Download the full code listing <a href="http://hobbitwerk.brinkster.net/metadeveloper/BasicDelegates2.zip">here</a>.<br /><br />Questions? david DOT(.)  seruyange AT(@) gmail DOT(.) com<br /><br /><span style="color: rgb(0, 0, 153);font-size:180%;" >}</span></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Tony</div>
<div class='content'>
Salut � tous, si vous �tes � la recherche d&#8217;une opportunit�<A HREF="http://www.miamitelecom.com" REL="nofollow">callback</A> de business pas contraignant, et sans besoin de vous d�placer, je vous recommande de vous lancer dans le callback t�l�phonique.<BR/>En effet, je suis tomb�e sur un site tr�s int�ressant:&#8221;miamitelecom&#8221;, qui propose des partenariats dans ce domaine, sans ou presque, apport financier initial.<BR/>Pour ceux qui ne connaissent pas, le callback est un syst�me de code ou de cartes t�l�phoniques (au choix), qui permet de t�l�phoner � l&#8217;�tranger � tr�s bas prix!!<BR/>Ces avantages: -1 seul num�ro utilisable � partir de n&#8217;importe quel t�l�phone, n&#8217;importe o� dans le monde. Ceci est tr�s avantageux pour les personnes qui voyagent beaucoup du fait de leur travail, ou pour celles vivant dans un pays pas tr�s d�velopp� en mati�re de t�l�communication par exemple.<BR/>                  - communication tr�s nette, contrairement au VOIP (=par  liaison internet, ce qui n&#8217;est pas du tout satisfaisant!!)<BR/>                   - Beaucoup moins couteux qu&#8217;un appel classic<BR/>                   - C&#8217;est vous qui d�cidez combien et quand vous voulez recharger en terme de temps de communication ( par le biais de carte bancaire ou autre)<BR/>En ce qui me concerne, j&#8217;en fais l&#8217;exp�rience en ce moment, et c&#8217;est un secteur en pleine expansion ( je distribue des acc�s surtout � des chefs d&#8217;entreprises, parcourrant la plan�te, ce qui leur permet d&#8217;�tre joint � n&#8217;importe quel moment sur un m�me num�ro!)<BR/>Je cible surtout l&#8217;Afrique en g�n�ral, et j&#8217;ai vu mon chiffre d&#8217;affaires exploser en quelques mois!<BR/>Si vous �tes int�ress�s, vous pouvez contacter Mr Corona de ma part (johanna), par mail � l&#8217;adresse suivante:www.callback@miamitelecom.com<BR/>Pour plus d&#8217;informations, vous pouvez aussi vous r�f�rer au site http://www.miamitelecom.comhttp://www.miamitelecom.com<BR/>Je vous recommande de vous y int�resser, cela peut vous rapporter gros!!!<BR/>Pour finir, et juste pour info, la soci�t� � ouvert un autre d�partement qui vaut le d�tour: http://www.miamicall.uscallback<BR/>Bien � vous.<BR/>Cordialement.<BR/>Johanna&#8230;..</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2005/04/21/winforms-combobox-itemdata/">WinForms ComboBox ItemData</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2005-04-21T22:46:00-05:00" pubdate data-updated="true">Apr 21<span>st</span>, 2005</time>
        
           | <a href="/2005/04/21/winforms-combobox-itemdata/#disqus_thread"
             data-disqus-identifier="http://blog.t3rse.com/2005/04/21/winforms-combobox-itemdata/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<span style="color: rgb(0, 0, 153);font-size:180%;" >{</span><br /><br />For the most part, I work with web based applications, in which a combo box works as you would expect.  The class <span style="font-weight: bold; color: rgb(255, 0, 0);">System.Web.UI.WebControls.DropDownList</span> has an <span style="color: rgb(255, 0, 0);">ListItemsCollection</span> which consists of <span style="color: rgb(255, 0, 0);">ListItem</span> types. So you can dump data into it using the ListItem class which accepts, in the constructor, arguments for text/value pairs. Your code would look something like this:<br /><br /><span style="font-size:85%;">ListItem li = <span style="color: rgb(51, 51, 255);">new </span>ListItem(&#8220;MyText&#8221;, &#8220;MyValue&#8221;);<br />MyDropDownList.Items.Add(li);</span><br /><br />You can shorten it with an <span style="font-style: italic;">anonymous</span> instance of the ListItem:<br /><br /><span style="font-size:85%;">MyDropDownList.Items.Add(<span style="color: rgb(51, 51, 255);">new</span> ListItem(&#8220;MyText&#8221;, &#8220;MyValue&#8221;));</span><br /><br />Hence, a lot of code people write to populate these from a database looks like this:<br /><br /><span style="font-size:85%;"><span style="color: rgb(51, 204, 0);">// code to connect, build command, etc&#8230;</span><br />SqlDataReader rsData = cmd.ExecuteReader(CommandBehavior.CloseConnection);<br /><span style="color: rgb(51, 51, 255);">while</span>(rsData.Read()){<br />MyDropDownList.Items.Add(<span style="color: rgb(51, 51, 255);">new</span> ListItem(rsData[&#8220;TextFld&#8221;].ToString(), rs[&#8220;ValueFld&#8221;].ToString()));<br />}<br />rsData.Close(); <span style="color: rgb(51, 204, 0);">// never forget to close</span><br /></span><br />Another way to do the same thing:<br /><br /><span style="color: rgb(51, 204, 0);font-size:85%;" >//code to connect, build command, etc&#8230;</span><br /><span style="font-size:85%;">SqlDataReader rsData = cmd.ExecuteReader(CommandBehavior.CloseConnection);<br />MyDropDownList.DataTextField = &#8220;TextFld&#8221;;<br />MyDropDownList.DataValueField = &#8220;ValueFld&#8221;;<br />MyDropDownList.DataSource = rsData;<br />MyDropDownList.DataBind();<br />rsData.Close(); <span style="color: rgb(51, 204, 0);">// never forget to close</span><br /><span style="font-size:100%;"><br />Whichever your fancy, the bottom line is that the DropDownList behaves as you expect it to: some text that displays to the user and an associated value which you can reference programmatically.</span><br /><br /><span style="font-size:100%;">In the Windows.Forms namespace, used for so called WinForms applications, the class <span style="font-weight: bold; color: rgb(255, 0, 0);">System.Windows.Forms.ComboBox</span> is the equivalent of the drop down list. However, the collection it uses for its items is different; it only seems to have a single value associated with it. How does one map text/value pairs?<br /><br />The underlying collection used by the WinForms ComboBox is of type <span style="color: rgb(255, 0, 0);">ObjectCollection</span>. Not too surprisingly, this is a collection of objects. You can, therefore, store any type of object as an item in this drop down list. For example, if I was keeping track of customer statuses, I may have the following data in a lookup table:<br /><br /><table border="1" bordercolor="black" cellpadding="3" cellspacing="1"><tbody><tr><td colspan="2" bgcolor="yellow">CUSTOMERSTATUSES</td></tr><br /><tr><td bgcolor="yellow">STATUSNAME</td><td bgcolor="yellow">STATUSCODE</td></tr><br /><tr><td>ACTIVE LOAN</td><td>ACT</td></tr><br /><tr><td>PAST DUE</td><td>DEL</td></tr><br /></tbody></table><br />I want a drop down with the status name for the user, but in my code I really care about the status code, not the name. The first thing I can do is build an object to reflect these values:<br /><br /><span style="color: rgb(51, 51, 255);">class </span>StatusData{<br /><span style="color: rgb(51, 51, 255);">private string</span> _StatusName;<br /><span style="color: rgb(51, 51, 255);">  private string</span> _StatusValue;<br /><br /><span style="color: rgb(51, 51, 255);">  public property</span> StatusName{<br /> <span style="color: rgb(51, 51, 255);">get</span>{<span style="color: rgb(51, 51, 255);">return</span> _StatusName;}<br /> <span style="color: rgb(51, 51, 255);">set</span>{_StatusName = <span style="color: rgb(51, 51, 255);">value</span>;}<br />}<br /></span></span><span style="font-size:85%;"><span style="font-size:100%;"><span style="color: rgb(51, 51, 255);">  public property</span> StatusValue{<br /> <span style="color: rgb(51, 51, 255);">get</span>{<span style="color: rgb(51, 51, 255);">return</span> _StatusValue;}<br /> <span style="color: rgb(51, 51, 255);">set</span>{_StatusValue = <span style="color: rgb(51, 51, 255);">value</span>;}<br />}<br /></span></span><span style="font-size:85%;"><span style="font-size:100%;">}<br /><br />I want to add these objects to the drop down, but I want the status name to be displayed. This is the purpose of the <span style="color: rgb(255, 0, 0);">DisplayMember </span>property of the <span style="color: rgb(255, 0, 0);">System.Windows.Forms.ComboBox</span> class. It will allow me to specify a property to utilize for display on an object that it&#8217;s storing:<br /></span></span><br /><span style="font-size:85%;">MyWinFormsDropDown.<span style="color: rgb(255, 0, 0);">DisplayMember </span>= &#8220;StatusName&#8221;;</span><br /><br />After I&#8217;ve specified that, I can then store all my Status objects as references in the ObjectCollection of the WinForms drop down list:<br /><span style="font-size:85%;"><br /><span style="color: rgb(51, 204, 0);">// build collection earlier</span><br /><span style="color: rgb(51, 51, 255);">foreach</span>(StatusData sd <span style="color: rgb(51, 51, 255);">in</span> StatusDataFromDB){<br />MyWinFormsDropDown.Items.Add(sd);<br />}</span><br /><br />Because I&#8217;ve already assigned the DisplayMember property, it knows which member of the hosted object to use to display. So how do I retrieve the value of the object StatusData that I&#8217;ve stored? Easy: cast the selected item from the drop down list, and then get any property that you want (in this case, we&#8217;ll get the value).<br /><br /><span style="font-size:85%;"><span style="color: rgb(51, 204, 0);">// in an event somewhere</span><br />StatusData s = (StatusData)MyWinFormsDropDown.SelectedItem;<br /><span style="color: rgb(51, 51, 255);">string </span>val = s.StatusValue;<br /></span><br />Seems like a massive chore, but if you think about it, there are already text/value datastructures that you can use without having to build unique classes for everything you want in a drop down list. For example, the handy <span style="color: rgb(255, 0, 0); font-weight: bold;">System.Collections.DictionaryEntry</span> would suffice. Try this on for size:<br /><br /><span style="font-size:85%;">DictionaryEntry d = <span style="color: rgb(51, 51, 255);">new </span>DictionaryEntry();<br />d.Key = &#8220;TestName&#8221;;<br />d.Value = &#8220;TestValue&#8221;;<br /><br />MyWinFormsDropDown.DisplayMember = &#8220;Key&#8221;;<br />MyWinFormsDropDown.Items.Add(d);<br /></span><br />Now, rather than building your own custom classes, you can use this provided class instead. But, the more thinking you do about it, the more you&#8217;ll realize that this is a bit more flexible functionality in the System.Windows.Forms.ComboBox than in its System.Web.UI.DropDownList cousin. Being able to reference an object with any number of values based on what is in a combobox is, to use some street vernacular, &#8220;sick.&#8221; (A good thing).<br /><br /><span style="font-size:180%;"><span style="color: rgb(0, 0, 153);">}</span></span></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>gerbster</div>
<div class='content'>
Thanks for this write up, very helpful.</div>
</div>
<div class='comment'>
<div class='author'>Chandy</div>
<div class='content'>
Nice writeup.  How do you provide a default selected item using just strings in the item collection and no code?</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2005/04/14/beginning-with-delegates-in-c/">Beginning With Delegates in C#</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2005-04-14T08:15:00-05:00" pubdate data-updated="true">Apr 14<span>th</span>, 2005</time>
        
           | <a href="/2005/04/14/beginning-with-delegates-in-c/#disqus_thread"
             data-disqus-identifier="http://blog.t3rse.com/2005/04/14/beginning-with-delegates-in-c/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<span style="color: rgb(51, 0, 153);font-size:180%;" >{</span><br /><br />Delegates are one of the mind benders of the .NET framework.  Not once have I been teaching the concept without feeling a bit of inadequacy at drawing up a clear and concise explanation.  Unless a developer has worked with function pointers in C, they are a new concept.  I&#8217;ll start off with the most basic example of delegate usage, after which I&#8217;ll write some posts with some more novel ways to leverage them.<br /><br />If I wrote the following line of code, you&#8217;d know what I mean:<br /><span style="font-size:85%;"><span style="color: rgb(51, 51, 255);">int </span>x = 3;</span><br /><br />We&#8217;ve declared a variable x and it points to the value &#8220;3&#8221; on the stack.<br /><br />If I wrote the next line of code, you&#8217;d also know what was meant:<br /><span style="font-size:85%;">Foo f = <span style="color: rgb(51, 102, 255);">new </span>Foo();</span><br /><br />We&#8217;ve declared a variable &#8220;f&#8221; and pointed it to an instance of the class &#8220;Foo&#8221; on the heap.<br /><br />I&#8217;m stating the obvious because if the previous two lines of code are understandable, you already know the very first thing about delegates: a delegate is a type, just like our primitive int or our class &#8220;Foo.&#8221;  The next leap that must be made is that a delegate points to a method somewhere in your code.<br /><br />Let&#8217;s expand the definition of the class Foo:<br /><br /><span style="font-size:85%;"><span style="color: rgb(51, 102, 255);">class </span>Foo{<br /> <span style="color: rgb(51, 102, 255);">public void</span> FooMeth(){ &#8230; }<br />}</span><br /><br />Is it possible to make a reference to the instance method FooMeth() somewhere in code?  Absolutely, my good man; that&#8217;s what the delegate is for.  To make a reference to this method, first define a delegate somewhere:<br /><br /><span style="font-size:85%;"><span style="color: rgb(51, 102, 255);font-size:85%;" >public delegate void </span>MethPointer()</span><br /><br />Let&#8217;s break that down: public - access modifier, accessible anywhere, void - this is a delegate that will point to a method that returns no value, MethPointer - this is the name of our delegate, and finally () - the empty parenthesis mean that the delegate will point to a method with no parameters.  Delegates are typesafe method pointers - the typesafe part is what you see in the definition: our delegate can only point to a method with an identical return value and parameter list.<br /><br />So now that we&#8217;ve defined our delegate, how do we create an instance that points to the instance method FooMeth() as we mentioned previously?  FooMeth() is an instance method, which means that we need an instance of the class first:<br /><br /><span style="font-size:85%;">Foo f = <span style="color: rgb(51, 102, 255);">new </span>Foo();</span><br /><br />Now we create a reference to the delegate in the following manner:<br /><br /><span style="font-size:85%;">MethPointer <span style="color: rgb(255, 102, 102);">d</span> = <span style="color: rgb(51, 102, 255);">new </span>MethPointer(f.FooMeth);</span><br /><br />We pass the method to the constructor of the delegate.  All the hard work is done.  To invoke the delegated method, we simply do the following:<br /><br /><span style="font-size:85%;"><span style="color: rgb(255, 102, 102);">d</span>();</span><br /><br />One more thing about syntax and then I&#8217;ll introduce a first basic usage for delegates.  If you got this far and you&#8217;re doing okay, this is a side note you should be able to figure out on your own.  A lot of the time, a delegate is declared as a public variable in a class.  Something like the following:<br /><br /><span style="font-size:85%;"><span style="color: rgb(51, 102, 255);">public class</span> MyClass{<br />  <span style="color: rgb(51, 102, 255);">public delegate void</span> Del();<br />}</span><br /><br />So the line above when we created a reference to it comes to us often as:<br /><br /><span style="color: rgb(51, 102, 255);font-size:85%;" ><span style="color: rgb(51, 0, 51);">MyClass.Del d =</span> new </span><span style="font-size:85%;">MyClass.Del(f.FooMeth);</span><br /><br />This is just a simple matter of understanding that if we declare something inside a class, we need to use the classname to access it.<br /><br />Now that we&#8217;ve got the syntax for a basic delegate, how on earth does one use such things?<br /><br />The example I always like to start with is a &#8220;callback&#8221;: you can call a remote method and pass a reference to a method in your local class.  For example, let&#8217;s say we had a database utility class called DB that had a RunLongQuery method.  This method runs a query against our database that sometimes takes 0.0005 seconds, but for large reports it can take 5, 10, sometimes 25 seconds.  Whenever the query finishes, you&#8217;d like to invoke a method from your application.<br /><br />So I&#8217;ve got a class MyDatabaseApp which makes a call to RunLongQuery from DB.  But we can design RunLongQuery to accept a reference to a method as a parameter by first putting a delegate in DB and then using it as a parameter on the method.  Check it out:<br /><br /><span style="font-size:85%;"><span style="color: rgb(51, 102, 255);">public class</span> DB{<br />  <span style="color: rgb(51, 102, 255);">public delegate void</span> Done();<br />  <span style="color: rgb(51, 102, 255);">public void</span> RunLongQuery(<span style="color: rgb(51, 102, 255);">string </span>sql, Done cback){<br />    // code from query<br />    cback(); // invoke the callback method<br />  }<br />}</span><br /><br />Let&#8217;s also look at the internals of the class MyDatabaseApp:<br /><br /><span style="font-size:85%;"><span style="color: rgb(51, 204, 255);"><span style="color: rgb(51, 102, 255);">public class</span> </span>MyDatabaseApp{<br />  <span style="color: rgb(51, 102, 255);">public void</span> FinishedQuery(){ &#8230; }<br /> <br />  <span style="color: rgb(51, 102, 255);">public void</span> MyAppQuery(){<br />    DB.Done <span style="color: rgb(255, 0, 0);">d</span> = <span style="color: rgb(51, 102, 255);">new </span>DB.Done(this.FinishedQuery);<br />    DB dbhelper = <span style="color: rgb(51, 102, 255);">new </span>DB();<br />    dbhelper.RunLongQuery(&#8220;select&#8230; &#8220;, <span style="color: rgb(255, 102, 102);">d</span>);<br />  }<br />}</span><br /><br />When MyAppQuery calls the RunLongQuery method from the instance of DB, dbhelper, it passes a delegate reference to the FinishedQuery method.  This will automatically be invoked when the query is completed - see inside the definition of DB to see how it&#8217;s being invoked.<br /><br />You can download a VS.NET 2003 example of the following <a href="http://hobbitwerk.brinkster.net/metadeveloper/BasicDelegates.zip">here</a> (~15kb).<br /><br />These are the very beginnings of delegates - our example is also quite trivial because it&#8217;s just a teaser for one of the more seductive <span style="font-style: italic;">asynchronous </span>callback that can be done with delegates.  But by this time, you should be aware that delegates are types - they can be referenced by variables and to create an instance of a delegate we need first to define the delegate and then pass a method that meets its requirements (return type and signature).<br /><br />Questions? david DOT(.)  seruyange AT(@) gmail DOT(.) com<br /><br /><span style="color: rgb(51, 0, 153);font-size:180%;" >}</span></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2005/03/15/done-not-dead/">Done, Not Dead</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2005-03-15T17:42:00-05:00" pubdate data-updated="true">Mar 15<span>th</span>, 2005</time>
        
           | <a href="/2005/03/15/done-not-dead/#disqus_thread"
             data-disqus-identifier="http://blog.t3rse.com/2005/03/15/done-not-dead/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<span style="color: rgb(0, 0, 102);font-size:180%;" >{</span><br /><br />Yesterday I found a link to<a href="http://classicvb.org/petition/"> a petition</a> of VB developers, many of whom are MVPs, demanding that Microsoft not abandon the language/tools that served them well for so many years.  I thought it was interesting because it went along much of the thread of &#8221;<a href="http://metadeveloper.blogspot.com/2005/02/soa-and-avalon-xaml.html">why not a better COM?</a>&#8221; which I&#8217;d started on earlier.<br /><br />Today I found <a href="http://www.danappleman.com/index.php?p=35">Appleman&#8217;s comments</a> on it; it appears that his take is that of <a href="http://www.pluralsight.com/blogs/dbox/default.aspx">Don Box</a> -  VB and COM are <span style="font-style: italic;">done</span> not <span style="font-style: italic;">dead</span>. <br /><br />Which is sort of interesting; there was a lot that could have been done to make classic VB even better and it&#8217;s as useful now as it ever was (except for fear that it may become unsupported).<br /><br />What were some of the things that could have been better?<br /><ul>   <li>An enhanced IDE</li>   <li>More advanced controls (better menus, better toolbar, lists, better browser/net controls)</li>   <li>New language constructs and datatypes (compound assignment, collection classes, etc)</li>   <li>COM cleanup (less reliance on the registry OR better tools for managing it, builtin version management).</li> </ul> There are many other things I could think of but it suffices to say that with a better classic VB we&#8217;d no doubt experience less &#8220;energy&#8221; about WinForms with the .NET framework.<br /><br />Anyhow, this seems almost passe for the likes of me. On to XAML and whatever else bleeds &#8220;new.&#8221;<br /><br />The petition has inspired quite a few retorts <a href="http://radio.weblogs.com/0001011/2005/03/08.html#a9568">here</a>, <a href="http://www.panopticoncentral.net/archive/2005/03/10/7951.aspx">here</a>, and <a href="http://swigartconsulting.blogs.com/tech_blender/2005/03/just_plain_wron.html">here</a>.<br /><br /><span style="color: rgb(0, 0, 102);font-size:180%;" >}</span></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2005/03/12/believe/">Believe.</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2005-03-12T18:30:00-06:00" pubdate data-updated="true">Mar 12<span>th</span>, 2005</time>
        
           | <a href="/2005/03/12/believe/#disqus_thread"
             data-disqus-identifier="http://blog.t3rse.com/2005/03/12/believe/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<span style="color: rgb(0, 0, 102);font-size:180%;" >{</span><br /><br /><a href="http://www.mozilla.org/projects/xul/">XUL</a> is <a href="http://www.faser.net/mab/chrome/content/mab.xul">good</a>.<br /><br /><span style="color: rgb(0, 0, 102);font-size:180%;" >}</span></div>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/40/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/38/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2014/06/04/trend-talk/">Trend Talk</a>
      </li>
    
      <li class="post">
        <a href="/2014/05/07/going-mac/">Going Mac: A Developer Encountering Operating Systems as Place</a>
      </li>
    
      <li class="post">
        <a href="/2014/05/06/moving-from-blogengine-dot-net-to-octopress/">Moving From BlogEngine.net to Octopress</a>
      </li>
    
      <li class="post">
        <a href="/2014/04/21/hello-from-octopress/">Hallo Welt: Octopress Edition</a>
      </li>
    
      <li class="post">
        <a href="/2014/02/23/The-Day-Barry-Ritholtz-Replied/">The Day Barry Ritholtz Replied</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/t3rse">@t3rse</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 't3rse',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - David aka t3rse -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 't3rse';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
