---
layout: post
title: "Office Interop with .NET"
date: 2005-10-30T20:35:00-08:00
---

<div class='post'>
<span style="font-size:180%;color:#000099;">{</span><br /><br /><span style="font-size:85%;">Are you still doing VBA with Office even though you know you should be doing your coding with the .NET Framework? Probably like many I did things the old way rather than dealing with COM Interop, especially since this was particularly daunting with Office. </span><br /><span style="font-size:85%;"></span><br /><span style="font-size:85%;">It isn't as of a while ago, but you, like me, may have been a bit too busy to notice. </span><br /><span style="font-size:85%;"></span><br /><span style="font-size:85%;">First, you must download the Office Interop Libraries from </span><a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=C41BD61E-3060-4F71-A6B4-01FEBA508E52&displaylang=en"><span style="font-size:85%;">here</span></a><span style="font-size:85%;">. The instructions are clear; run the <em>register.bat</em> from the VS.NET command prompt. After that you can make a reference to the application interop assembly of your choice, such as Microsoft.Office.Interop.Excel.dll.</span><br /><span style="font-size:85%;"></span><br /><span style="font-size:85%;">Reference the namespace in your app:<br /><span style="color:#ff0000;">using Excel = Microsoft.Office.Interop.Excel;</span></span><br /><span style="font-size:85%;"></span><br /><span style="font-size:85%;">Code away:</span><br /><br /><span style="font-size:85%;color:#ff0000;">Excel.Application app = new Excel.Application();<br />Excel.Workbook book = app.Workbooks.Open(@"c:\data\Daita.xls",Type.Missing, Type.Missing, Type.Missing, Type.Missing,<br />Type.Missing, Type.Missing, Type.Missing, Type.Missing,<br />Type.Missing, Type.Missing, Type.Missing, Type.Missing,<br />Type.Missing, Type.Missing);<br />Excel.Worksheet sheet = (Excel.Worksheet)book.Worksheets[1];<br />for(int i=1;i<10;i++) j="1;j<7;j++)" rg =" (Excel.Range)sheet.Cells[i,j];"><br /><br /><span style="color:#000000;"><span style="font-size:85%;">A few interesting things:</span><br /></span><ul><li><span style="font-size:85%;color:#000000;">The Type.Missing passed for all those COM-esque optional parameters. Ugh.</span></li><li><span style="font-size:85%;color:#000000;">Casting the cell you are on into a Excel.Range when you need to access its contents.</span></li></ul><span style="font-size:85%;"></span><br /><span style="color:#000000;"><span style="font-size:85%;">Finally:</span><br /><span style="font-size:85%;">Many more articles can be found </span></span><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dv_wrcore/html/wroriAutomatingOfficeApplications.asp"><span style="font-size:85%;color:#000000;">here</span></a><span style="font-size:85%;color:#000000;">, on MSDN.</span><br /><br /><span style="font-size:180%;color:#000099;">}</span><br /></span><span style="font-size:85%;color:#ff0000;"></span></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>[konoimo]   &gt;-</div>
<div class='content'>
Interesting post man... have you tried this with ASP.net? I do mostly web apps and it would be cool if I can use interop with ASP.net...</div>
</div>
</div>
