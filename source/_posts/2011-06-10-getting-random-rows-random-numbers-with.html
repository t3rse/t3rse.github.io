---
layout: post
title: "Getting Random Rows, Random Numbers with Sql Server"
date: 2011-06-10T06:05:00-07:00
---

<div class='post'>
<h2><font color="#0000ff">{</font></h2>  <p>The 5 second version of this, should you arrive via search, is that to get random rows, simply use an TOP query with&#160; <strong><em>ORDER BY NewId()</em></strong> expression. It’s really that simple! Take a look: </p>  <pre class="brush:sql">-- SAMPLE TABLE<br />CREATE TABLE Keywords(<br />	KeywordId INT IDENTITY(1,1) PRIMARY KEY, <br />	KeywordValue VARCHAR(50)<br />)<br />GO<br /><br />-- SAMPLE DATA<br />DECLARE @N INT<br />SET @N = 1<br />WHILE @N &lt; 101 BEGIN<br />	INSERT INTO Keywords(KeywordValue)<br />		VALUES('key word ' + CONVERT(VARCHAR(5), @N))<br />	SET @N = @N + 1<br />END<br /><br />-- A TOP QUERY WITH ORDER BY NEWID()<br />SELECT TOP 5 * FROM Keywords ORDER BY NEWID()</pre><br /><br /><p>The longer version of this is that I recently was asked to generate random keywords for a website I was working on with a lookup table. Getting random numbers in TSQL is easy, the RAND() function does all the magic but getting rows is a lot more tricky, especially if you want to make sure you exclude anything you’ve previously retrieved. The above technique worked quite well and made it easy to allow for them to add and remove keywords on demand. </p><br /><br /><p>One interesting application of this is that you can combine it with RAND() to get random numbers via multiplier and random rows (RAND gets a random between 0 and 1 leaving you the responsibility to multiply it to control the range you want). </p><br /><br /><p>Here is where I thought this could be taken as a flexible way to get random numbers within a bounded range: </p><br /><br /><pre class="brush:sql">-- get a series of random numbers<br />SELECT TOP 5 Rand() * KeywordId FROM Keywords ORDER BY NEWID()</pre><br /><br /><p>There’s a lot of flexibility but SQL Server makes it trivial.&#160; </p><br /><br /><h2><font color="#0000ff">}</font></h2>  </div>
